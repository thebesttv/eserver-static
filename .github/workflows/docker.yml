name: Build & cache Emacs Docker image

on:
  push:
    branches:
      - '*'                     # run on all branches
    paths:
      - 'docker/**'
      - '.github/workflows/docker.yml'
  workflow_dispatch:

jobs:
  Build-and-cache-image:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v3
      - name: Build image
        run: |
          cd docker/
          docker build -t emacs --build-arg UNAME=$(whoami) --build-arg UID=$(id -u) --build-arg GID=$(id -g) .
      - name: Setup Debug Session
        uses: csexton/debugger-action@master
